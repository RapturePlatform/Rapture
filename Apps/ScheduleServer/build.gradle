version = '3.0.4'

apply plugin: 'application'

jar.manifest.attributes "Implementation-Title" : "Rapture ScheduleServer application"
jar.manifest.attributes "Implementation-Version" : version

dependencies {
    implementation "net.rapture:MongoDb:$project.platformVersion"
    implementation "net.rapture:RabbitMQ:$project.platformVersion"
    implementation "net.rapture:RaptureCore:$project.platformVersion"
    implementation "net.rapture:RaptureAddinCore:$project.platformVersion"
    implementation libs.jline
}

mainClassName = "rapture.server.ScheduleServer"

// Config files
//

import groovy.text.*
import java.io.*


compileJava {
    dependsOn copyConfigFiles
}

startScripts {
       doLast {
             unixScript.text = unixScript.text.replace('DEFAULT_JVM_OPTS=""',
             'DEFAULT_JVM_OPTS="-Dcom.sun.management.jmxremote -Dcom.sun.management.jmxremote.port=9013 -Dcom.sun.management.jmxremote.local.only=false -Dcom.sun.management.jmxremote.authenticate=false"')
            }
        }
